!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).toTextile=e()}(function(){return function r(i,o,a){function l(n,e){if(!o[n]){if(!i[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(c)return c(n,!0);e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}t=o[n]={exports:{}};i[n][0].call(t.exports,function(e){var t=i[n][1][e];return l(t||e)},t,t.exports,r,i,o,a)}return o[n].exports}for(var c="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,n){var f,d,i=e("./lib/tex-converters"),o=e("./lib/gfm-converters"),a=e("./lib/html-parser"),l=e("collapse-whitespace"),r=["address","article","aside","audio","blockquote","body","canvas","center","dd","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frameset","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","isindex","li","main","menu","nav","noframes","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul"];function p(e){return-1!==r.indexOf(e.nodeName.toLowerCase())}var c=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function m(e){return-1!==c.indexOf(e.nodeName.toLowerCase())}function h(e){for(var t="",n=0;n<e.childNodes.length;n++)1===e.childNodes[n].nodeType?t+=e.childNodes[n]._replacement:3===e.childNodes[n].nodeType&&(t+=e.childNodes[n].data);return t}function g(e,t){var n,r,e="left"===e?(n=t.previousSibling,/ $/):(n=t.nextSibling,/^ /);return n&&(3===n.nodeType?r=e.test(n.nodeValue):1!==n.nodeType||p(n)||(r=e.test(n.textContent))),r}function u(e,t){var n,r=h(e);if(m(e)||/A|TH|TD/.test(e.nodeName)||!/^\s*$/i.test(r)){for(var i,o,a,l,c=0;c<d.length;c++){var u=d[c];if(((e,t)=>{if("string"==typeof t)return t===e.nodeName.toLowerCase();if(Array.isArray(t))return-1!==t.indexOf(e.nodeName.toLowerCase());if("function"==typeof t)return t.call(f,e);throw new TypeError("`filter` needs to be a string, array, or function")})(e,u.filter)){if("function"!=typeof u.replacement)throw new TypeError("`replacement` needs to be a function that returns a string");o=r,l=a=s=void 0,l=a="",p(i=e)||(s=/^[ \r\n\t]/.test(o),o=/[ \r\n\t]$/.test(o),s&&!g("left",i)&&(a=" "),o&&!g("right",i)&&(l=" "));var s={leading:a,trailing:l};(s.leading||s.trailing)&&(r=r.trim()),n=s.leading+u.replacement.call(f,r,e,t)+s.trailing;break}}e._replacement=n}else e._replacement=""}(f=function(e,t){if(t=t||{},"string"!=typeof e)throw new TypeError(e+" is not a string");if(""===e)return"";t.ignorePotentialOlTriggers||(e=e.replace(/(\d+)\. /g,"$1\\. "));e=e,e=(new a).parseFromString(e,"text/html"),l(e.documentElement,p);var e=e.body,n=(e=>{for(var t,n,r,i=[e],o=[];0<i.length;)for(t=i.shift(),o.push(t),n=t.childNodes,r=0;r<n.length;r++)1===n[r].nodeType&&i.push(n[r]);return o.shift(),o})(e);d=i.slice(0),t.gfm&&(d=o.concat(d)),t.converters&&(d=t.converters.concat(d)),!1!==t.attributeBlocks&&(t.attributeBlocks=!0);for(var r=n.length-1;0<=r;r--)u(n[r],t);return h(e).replace(/^[\t\r\n]+|[\t\r\n\s]+$/g,"").replace(/\n\s+\n/g,"\n\n").replace(/\n{3,}/g,"\n\n")}).isBlock=p,f.isVoid=m,f.outer=function(e,t){return e.cloneNode(!1).outerHTML.replace("><",">"+t+"<")},t.exports=f},{"./lib/gfm-converters":2,"./lib/html-parser":3,"./lib/tex-converters":4,"collapse-whitespace":6}],2:[function(e,t,n){t.exports=[]},{}],3:[function(e,t,n){var r,i="undefined"!=typeof window?window:this;function o(){}t.exports=(()=>{var e=i.DOMParser,t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(e){}return t})()?i.DOMParser:("undefined"==typeof document?(r=e("jsdom"),o.prototype.parseFromString=function(e){return r.jsdom(e,{features:{FetchExternalResources:[],ProcessExternalResources:!1}})}):(()=>{var t=!1;try{document.implementation.createHTMLDocument("").open()}catch(e){window.ActiveXObject&&(t=!0)}return t})()?o.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:o.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},o)},{jsdom:void 0}],4:[function(e,t,n){var r=[{filter:/padding-left:\s*([0-9]+)\s*em\s*;?/i,replacement:function(e,t){return Array(parseInt(t)+1).join("(")}},{filter:/padding-right:\s*([0-9]+)\s*em\s*;?/i,replacement:function(e,t){return Array(parseInt(t)+1).join(")")}},{filter:/text-align:\s*left\s*;?\s*;?/i,replacement:function(){return"<"}},{filter:/text-align:\s*right\s*;?/i,replacement:function(){return">"}},{filter:/text-align:\s*center\s*;?/i,replacement:function(){return"="}},{filter:/text-align:\s*justify\s*;?/i,replacement:function(){return"<>"}}],o=[{filter:/\Walign:\s*left\s*;?\s*;?/i,replacement:function(){return"<"}},{filter:/\Walign:\s*right\s*;?/i,replacement:function(){return">"}},{filter:/\Walign:\s*center\s*;?/i,replacement:function(){return"="}}];function c(e){var t=/^(color|width|height|border|background|padding|margin|font|float)(-[a-z]+)*:\s*((\d+%?|\d+px|\d+(\.\d+)?em|#[0-9a-f]+|[a-z]+|rgb\(\d+,\s*\d+,\s*\d+\))\s*)+$/i,e=e.split(/\s*;\s*/).filter(function(e){return t.test(e)});return 0===e.length?"":"{"+e.map(function(e){return e.replace(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/g,function(e,t,n,r){return"#"+[t,n,r].map(function(e){return("0"+parseInt(e).toString(16)).slice(-2)}).join("")})+";"}).sort().join(" ")+"}"}function a(e,t){var n,r=[];if(e.style.length){var i=e.style.cssText;if(t)for(var o=0;o<t.length&&0<i.length;o++){var a=t[o],l=i.match(a.filter);l&&(r.push(a.replacement.apply(a,l)),i=i.replace(a.filter,"").trim())}i.length&&r.push(c(i))}return r.join("")+(0<(e=e).className.length||e.id?(n="",0<e.className.length&&(n=e.className),e.id&&(n+="#"+e.id),"("+n+")"):"")}function u(e){return a(e,null)}function i(e){return a(e,r)}t.exports=[{filter:"p",replacement:function(e,t,n){n=n.attributeBlocks?i(t):"";return n.length?"\n\np"+n+". "+e+"\n\n":"\n\n"+e+"\n\n"}},{filter:"br",replacement:function(){return"  \n"}},{filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,n){return"\n\n"+(t.nodeName.toLowerCase()+(n.attributeBlocks?i(t):""))+". "+e+"\n\n"}},{filter:["em","i"],replacement:function(e,t,n){return"_"+(n.attributeBlocks?u(t):"")+e+"_"}},{filter:["strong","b"],replacement:function(e,t,n){return"**"+(n.attributeBlocks?u(t):"")+e+"**"}},{filter:["span"],replacement:function(e,t,n){return"(caps)"==(n.attributeBlocks?u(t):"")?e:"%"+u(t)+e+"%"}},{filter:["cite"],replacement:function(e,t,n){return"??"+(n.attributeBlocks?u(t):"")+e+"??"}},{filter:["del"],replacement:function(e,t,n){return"-"+(n.attributeBlocks?u(t):"")+e+"-"}},{filter:["ins"],replacement:function(e,t,n){return"+"+(n.attributeBlocks?u(t):"")+e+"+"}},{filter:["sup"],replacement:function(e,t,n){return"^"+(n.attributeBlocks?u(t):"")+e+"^"}},{filter:["sub"],replacement:function(e,t,n){return"~"+(n.attributeBlocks?u(t):"")+e+"~"}},{filter:function(e){var t=e.previousSibling||e.nextSibling,t="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!t},replacement:function(e,t,n){return"@"+(n.attributeBlocks?u(t):"")+e+"@"}},{filter:function(e){return"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,n){return'"'+e+(t.title?" ("+t.title+")":"")+'":'+t.getAttribute("href")}},{filter:"img",replacement:function(e,t,n){var r=t.alt||"",i=t.getAttribute("src")||"",r=t.title||r,r=r.length?"("+r+")":"";return i?"!"+(n.attributeBlocks?a(t,o):"")+i+r+"!":""}},{filter:function(e){return"PRE"===e.nodeName&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){return"\n\nbc"+(n.attributeBlocks?i(t):"")+". "+t.firstChild.textContent+"\n\n"}},{filter:"blockquote",replacement:function(e,t,n){return e=(e=e.trim()).replace(/\n{3,}/g,"\n\n"),"\n\nbq"+(n.attributeBlocks?i(t):"")+". "+e+"\n\n"}},{filter:"li",replacement:function(e,t,n){return(/ul/i.test(t.parentNode.nodeName)?"* ":"# ")+e}},{filter:["ul","ol"],replacement:function(e,t,n){for(var r=[],i=n.attributeBlocks?u(t):"",o=0;o<t.childNodes.length;o++)0==o&&i.length?r.push(t.childNodes[o]._replacement.replace(/ /,i+" ")):r.push(t.childNodes[o]._replacement);for(var a=!1;/li/i.test(t.parentNode.nodeName);){a=!0,t=t.parentNode.parentNode;for(var l=/ul/i.test(t.nodeName)?"*":"#",o=0;o<r.length;o++)r[o]=l+r[o]}return a?"\n"+r.join("\n"):"\n\n"+r.join("\n")+"\n\n"}},{filter:function(e){return this.isBlock(e)},replacement:function(e,t){return"\n\n"+this.outer(t,e)+"\n\n"}},{filter:function(){return!0},replacement:function(e,t){return this.outer(t,e)}}]},{}],5:[function(e,t,n){t.exports=["address","article","aside","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tfoot","ul","video"]},{}],6:[function(e,t,n){var c=e("void-elements"),r=(Object.keys(c).forEach(function(e){c[e.toUpperCase()]=1}),{});function u(e){return!(!e||!r[e.nodeName])}function s(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function f(e,t){return e&&e.parentNode===t||"PRE"===t.nodeName?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}e("block-elements").forEach(function(e){r[e.toUpperCase()]=1}),t.exports=function(e,t){if(e.firstChild&&"PRE"!==e.nodeName){"function"!=typeof t&&(t=u);for(var n=null,r=!1,i=f(l=null,e);i!==e;){if(3===i.nodeType){var o=i.data.replace(/[ \r\n\t]+/g," ");if(!(o=n&&!/ $/.test(n.data)||r||" "!==o[0]?o:o.substr(1))){i=s(i);continue}i.data=o,n=i}else{if(1!==i.nodeType){i=s(i);continue}t(i)||"BR"===i.nodeName?(n&&(n.data=n.data.replace(/ $/,"")),n=null,r=!1):(o=i)&&c[o.nodeName]&&(r=!(n=null))}var a=f(l,i),l=i,i=a}n&&(n.data=n.data.replace(/ $/,""),n.data||s(n))}}},{"block-elements":5,"void-elements":7}],7:[function(e,t,n){t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},{}]},{},[1])(1)});